Siesta Version  : v4.1-b4
Architecture    : linux
Compiler version: GNU Fortran (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
Compiler flags  : mpif90 -g -fPIC -O3 -ftree-vectorize
PP flags        : -DFC_HAVE_ABORT -DSIESTA__DIAG_2STAGE -DSIESTA__MRRR -DMPI
Libraries       :  -Wl,-Bstatic -Wl,--start-group -lmkl_scalapack_lp64 -lmkl_blacs_intelmpi_lp664 -lmkl_intel_lp64 -lmkl_sequential -lmkl_core -Wl,--end-group -Wl,-Bdynamic
PARALLEL version

* Running on 6 nodes in parallel
>> Start of run:  28-AUG-2019  13:16:13

                           ***********************       
                           *  WELCOME TO SIESTA  *       
                           ***********************       

reinit: Reading from standard input
reinit: Dumped input in INPUT_TMP.16279
************************** Dump of input data file ****************************
# Siesta input file
         # -- SELF-CONSISTENT FIELD --
MeshCutoff                   400 Ry
PAO.EnergyShift              30 meV
XC.Functional                GGA
XC.Authors                   PBE
MaxSCFIterations             1000
         # -- MOLECULAR DYNAMICS --
MD.TypeOfRun                 Broyden
MD.NumCGsteps                1000
MD.MaxForceTol               0.01 eV/Ang
         # -- BRILLOUIN ZONE --
%block KgridMonkhorstPack
  25   0   0   0.0
   0  25   0   0.0
   0   0   1   0.0
%endblock KgridMonkhorstPack
Diag.ParallelOverK           true                # Default: false
         # -- ELECTRONIC PROPERTIES --
BandLinesScale                ReciprocalLatticeVectors
%block BandLines
  1  0.00000000  0.00000000  0.00000000  Gamma
 50  0.66666666  0.33333333  0.00000000  K
 50  0.50000000  0.00000000  0.00000000  M
 50  0.00000000  0.00000000  0.00000000  Gamma
%endblock BandLines
%block PDOS.kgridMonkhorstPack
 300   0   0   0.0
   0 300   0   0.0
   0   0   1   0.0
%endblock PDOS.kgridMonkhorstPack
%block ProjectedDensityOfStates
  -10.0   0.0   0.04    300    eV
%endblock ProjectedDensityOfStates
         # -- MATERIAL --
SystemLabel                  Graphene
WriteCoorStep                true
WriteCoorXmol                true
%block ChemicalSpeciesLabel
 1   6   C.gga
%endblock ChemicalSpeciesLabel
LatticeConstant              1.000 Ang
%block LatticeVectors
        2.15598929    -1.24476100    0.00000000
        2.15598929     1.24476100    0.00000000
        0.00000000     0.00000000   20.00000000
%endblock LatticeVectors
AtomicCoordinatesFormat      ScaledByLatticeVectors
%block AtomicCoordinatesAndAtomicSpecies
    0.33333333    0.33333333    0.50000000 1
    0.66666666    0.66666666    0.50000000 1
%endblock AtomicCoordinatesAndAtomicSpecies
************************** End of input data file *****************************

reinit: -----------------------------------------------------------------------
reinit: System Name: 
reinit: -----------------------------------------------------------------------
reinit: System Label: Graphene
reinit: -----------------------------------------------------------------------

initatom: Reading input for the pseudopotentials and atomic orbitals ----------
Species number:   1 Atomic number:    6 Label: C.gga

Ground state valence configuration:   2s02  2p02
Reading pseudopotential information in formatted form from C.gga.psf

Valence configuration for pseudopotential generation:
2s( 2.00) rc: 1.54
2p( 2.00) rc: 1.54
3d( 0.00) rc: 1.54
4f( 0.00) rc: 1.54
For C.gga, standard SIESTA heuristics set lmxkb to 3
 (one more than the basis l, including polarization orbitals).
Use PS.lmax or PS.KBprojectors blocks to override.

<basis_specs>
===============================================================================
C.gga                Z=   6    Mass=  12.010        Charge= 0.17977+309
Lmxo=1 Lmxkb= 3    BasisType=split      Semic=F
L=0  Nsemic=0  Cnfigmx=2
          n=1  nzeta=2  polorb=0
            splnorm:   0.15000    
               vcte:    0.0000    
               rinn:    0.0000    
               qcoe:    0.0000    
               qyuk:    0.0000    
               qwid:   0.10000E-01
                rcs:    0.0000      0.0000    
            lambdas:    1.0000      1.0000    
L=1  Nsemic=0  Cnfigmx=2
          n=1  nzeta=2  polorb=1
            splnorm:   0.15000    
               vcte:    0.0000    
               rinn:    0.0000    
               qcoe:    0.0000    
               qyuk:    0.0000    
               qwid:   0.10000E-01
                rcs:    0.0000      0.0000    
            lambdas:    1.0000      1.0000    
-------------------------------------------------------------------------------
L=0  Nkbl=1  erefs: 0.17977+309
L=1  Nkbl=1  erefs: 0.17977+309
L=2  Nkbl=1  erefs: 0.17977+309
L=3  Nkbl=1  erefs: 0.17977+309
===============================================================================
</basis_specs>

atom: Called for C.gga                 (Z =   6)

read_vps: Pseudopotential generation method:
read_vps: ATM3      Troullier-Martins                       
Total valence charge:    4.00000

read_vps: Pseudopotential includes a core correction:
read_vps: Pseudo-core for xc-correction

xc_check: Exchange-correlation functional:
xc_check: GGA Perdew, Burke & Ernzerhof 1996
V l=0 = -2*Zval/r beyond r=  1.5227
V l=1 = -2*Zval/r beyond r=  1.5227
V l=2 = -2*Zval/r beyond r=  1.5227
V l=3 = -2*Zval/r beyond r=  1.5038
All V_l potentials equal beyond r=  1.5227
This should be close to max(r_c) in ps generation
All pots = -2*Zval/r beyond r=  1.5227

VLOCAL1: 99.0% of the norm of Vloc inside     18.722 Ry
VLOCAL1: 99.9% of the norm of Vloc inside     42.668 Ry
atom: Maximum radius for 4*pi*r*r*local-pseudopot. charge    1.83678
atom: Maximum radius for r*vlocal+2*Zval:    1.58088
GHOST: No ghost state for L =  0
GHOST: No ghost state for L =  1
GHOST: No ghost state for L =  2
GHOST: No ghost state for L =  3

KBgen: Kleinman-Bylander projectors: 
   l= 0   rc=  1.704034   el= -1.009801   Ekb=  5.335044   kbcos=  0.316824
   l= 1   rc=  1.704034   el= -0.388707   Ekb= -3.785862   kbcos= -0.366464
   l= 2   rc=  1.791422   el=  0.001971   Ekb= -0.970471   kbcos= -0.009212
   l= 3   rc=  1.859892   el=  0.003065   Ekb= -0.399525   kbcos= -0.001223

KBgen: Total number of  Kleinman-Bylander projectors:   16
atom: -------------------------------------------------------------------------

atom: SANKEY-TYPE ORBITALS:
atom: Selected multiple-zeta basis: split     

SPLIT: Orbitals with angular momentum L= 0

SPLIT: Basis orbitals for state 2s

SPLIT: PAO cut-off radius determined from an
SPLIT: energy shift=  0.002205 Ry

   izeta = 1
                 lambda =    1.000000
                     rc =    5.382558
                 energy =   -1.007983
                kinetic =    0.829025
    potential(screened) =   -1.837009
       potential(ionic) =   -5.376592

   izeta = 2
                 rmatch =    3.475094
              splitnorm =    0.150000
                 energy =   -0.876935
                kinetic =    1.279964
    potential(screened) =   -2.156899
       potential(ionic) =   -5.943761

SPLIT: Orbitals with angular momentum L= 1

SPLIT: Basis orbitals for state 2p

SPLIT: PAO cut-off radius determined from an
SPLIT: energy shift=  0.002205 Ry

   izeta = 1
                 lambda =    1.000000
                     rc =    6.740804
                 energy =   -0.386704
                kinetic =    2.327316
    potential(screened) =   -2.714020
       potential(ionic) =   -6.100339

   izeta = 2
                 rmatch =    3.792903
              splitnorm =    0.150000
                 energy =   -0.270625
                kinetic =    3.420974
    potential(screened) =   -3.691599
       potential(ionic) =   -7.453004

POLgen: Perturbative polarization orbital with L=  2

POLgen: Polarization orbital for state 2p

   izeta = 1
                     rc =    6.740804
                 energy =    0.975645
                kinetic =    2.058046
    potential(screened) =   -1.082401
       potential(ionic) =   -3.782952
atom: Total number of Sankey-type orbitals: 13

atm_pop: Valence configuration (for local Pseudopot. screening):
 2s( 2.00)                                                            
 2p( 2.00)                                                            
Vna: chval, zval:    4.00000   4.00000

Vna:  Cut-off radius for the neutral-atom potential:   6.740804
comcore: Pseudo-core radius Rcore=  1.791422

atom: _________________________________________________________________________

prinput: Basis input ----------------------------------------------------------

PAO.BasisType split     

%block ChemicalSpeciesLabel
    1    6 C.gga                   # Species index, atomic number, species label
%endblock ChemicalSpeciesLabel

%block PAO.Basis                 # Define Basis set
C.gga                 2                    # Species label, number of l-shells
 n=2   0   2                         # n, l, Nzeta 
   5.383      3.475   
   1.000      1.000   
 n=2   1   2 P   1                   # n, l, Nzeta, Polarization, NzetaPol
   6.741      3.793   
   1.000      1.000   
%endblock PAO.Basis

prinput: ----------------------------------------------------------------------

coor:   Atomic-coordinates input format  =     Fractional

siesta: Atomic coordinates (Bohr) and species
siesta:      2.71615   0.00000  18.89727  1        1
siesta:      5.43231   0.00000  18.89727  1        2

siesta: System type = slab      

initatomlists: Number of atoms, orbitals, and projectors:      2    26    32

coxmol: Writing XMOL coordinates into file Graphene.xyz                                                        

siesta: ******************** Simulation parameters ****************************
siesta:
siesta: The following are some of the parameters of the simulation.
siesta: A complete list of the parameters used, including default values,
siesta: can be found in file out.fdf
siesta:
redata: Spin configuration                          = none
redata: Number of spin components                   = 1
redata: Time-Reversal Symmetry                      = T
redata: Spin-spiral                                 = F
redata: Long output                                 =   F
redata: Number of Atomic Species                    =        1
redata: Charge density info will appear in .RHO file
redata: Write Mulliken Pop.                         = NO
redata: Matel table size (NRTAB)                    =     1024
redata: Mesh Cutoff                                 =   400.0000 Ry
redata: Net charge of the system                    =     0.0000 |e|
redata: Min. number of SCF Iter                     =        0
redata: Max. number of SCF Iter                     =     1000
redata: SCF convergence failure will abort job
redata: SCF mix quantity                            = Hamiltonian
redata: Mix DM or H after convergence               =   F
redata: Recompute H after scf cycle                 =   F
redata: Mix DM in first SCF step                    =   T
redata: Write Pulay info on disk                    =   F
redata: New DM Mixing Weight                        =     0.2500
redata: New DM Occupancy tolerance                  = 0.000000000001
redata: No kicks to SCF
redata: DM Mixing Weight for Kicks                  =     0.5000
redata: Require Harris convergence for SCF          =   F
redata: Harris energy tolerance for SCF             =     0.000100 eV
redata: Require DM convergence for SCF              =   T
redata: DM tolerance for SCF                        =     0.000100
redata: Require EDM convergence for SCF             =   F
redata: EDM tolerance for SCF                       =     0.001000 eV
redata: Require H convergence for SCF               =   T
redata: Hamiltonian tolerance for SCF               =     0.001000 eV
redata: Require (free) Energy convergence for SCF   =   F
redata: (free) Energy tolerance for SCF             =     0.000100 eV
redata: Using Saved Data (generic)                  =   F
redata: Use continuation files for DM               =   F
redata: Neglect nonoverlap interactions             =   F
redata: Method of Calculation                       = Diagonalization
redata: Electronic Temperature                      =   299.9869 K
redata: Fix the spin of the system                  =   F
redata: Dynamics option                             = Broyden coord. optimization
redata: Variable cell                               =   F
redata: Maximum number of CG moves                  =     1000
redata: Force tolerance                             =     0.0100 eV/Ang
mix.SCF: Pulay mixing                            = Pulay
mix.SCF:    Variant                              = stable
mix.SCF:    History steps                        = 2
mix.SCF:    Linear mixing weight                 =     0.250000
mix.SCF:    Mixing weight                        =     0.250000
mix.SCF:    SVD condition                        = 0.1000E-07
redata: ***********************************************************************

%block SCF.Mixers
  Pulay
%endblock SCF.Mixers

%block SCF.Mixer.Pulay
  # Mixing method
  method pulay
  variant stable

  # Mixing options
  weight 0.2500
  weight.linear 0.2500
  history 2
%endblock SCF.Mixer.Pulay

DM_history_depth set to one: no extrapolation allowed by default for geometry relaxation
Size of DM history Fstack: 1
Total number of electrons:     8.000000
Total ionic charge:     8.000000

* ProcessorY, Blocksize:    2   4


* Orbital distribution balance (max,min):     6     4

 Kpoints in:          325 . Kpoints trimmed:          313

siesta: k-grid: Number of k-points =   313
siesta: k-grid: Cutoff (effective) =    10.000 Ang
siesta: k-grid: Supercell and displacements
siesta: k-grid:   25   0   0      0.000
siesta: k-grid:    0  25   0      0.000
siesta: k-grid:    0   0   1      0.000

diag: Algorithm                                     = D&C
diag: Parallel over k                               =   T
diag: Use parallel 2D distribution                  =   T
diag: Parallel block-size                           = 4
diag: Parallel distribution                         =     2 x     3
diag: Used triangular part                          = Lower
diag: Absolute tolerance                            =  0.100E-15
diag: Orthogonalization factor                      =  0.100E-05
diag: Memory factor                                 =  1.0000
k-point displ. along   1 input, could be:     0.00    0.50
k-point displ. along   2 input, could be:     0.00    0.50
 Kpoints in:        45300 . Kpoints trimmed:        45151

siesta: PDOS.k-grid: Number of k-points = 45151
siesta: PDOS.k-grid: Cutoff (effective) =    10.000 Ang
siesta: PDOS.k-grid: Supercell and displacements
siesta: PDOS.k-grid:  300   0   0      0.000
siesta: PDOS.k-grid:    0 300   0      0.000
siesta: PDOS.k-grid:    0   0   1      0.000
Using current reciprocal lattice vectors for BandLinesScale
Beware any cell changes by the end of the run
Using current reciprocal lattice vectors for BandLinesScale
Beware any cell changes by the end of the run

superc: Internal auxiliary supercell:     9 x     9 x     1  =      81
superc: Number of atoms, orbitals, and projectors:    162   2106   2592


ts: **************************************************************
ts: Save H and S matrices                           =    F
ts: Save DM and EDM matrices                        =    F
ts: Fix Hartree potential                           =    F
ts: Only save the overlap matrix S                  =    F
ts: **************************************************************

************************ Begin: TS CHECKS AND WARNINGS ************************
************************ End: TS CHECKS AND WARNINGS **************************


                     ====================================
                        Begin Broyden opt. move =      0
                     ====================================

outcoor: Atomic coordinates (fractional):                   
    0.33333333    0.33333333    0.50000000   1       1  C.gga
    0.66666666    0.66666666    0.50000000   1       2  C.gga

superc: Internal auxiliary supercell:     9 x     9 x     1  =      81
superc: Number of atoms, orbitals, and projectors:    162   2106   2592

outcell: Unit cell vectors (Ang):
        2.155989   -1.244761    0.000000
        2.155989    1.244761    0.000000
        0.000000    0.000000   20.000000

outcell: Cell vector modules (Ang)   :    2.489522    2.489522   20.000000
outcell: Cell angles (23,13,12) (deg):     90.0000     90.0000     60.0000
outcell: Cell volume (Ang**3)        :    107.3477
<dSpData1D:S at geom step 0
  <sparsity:sparsity for geom step 0
    nrows_g=26 nrows=6 sparsity=8.2101 nnzs=5550, refcount: 7>
  <dData1D:(new from dSpData1D) n=5550, refcount: 1>
refcount: 1>
new_DM -- step:     1
Initializing Density Matrix...
DM filled with atomic data:
<dSpData2D:DM initialized from atoms
  <sparsity:sparsity for geom step 0
    nrows_g=26 nrows=6 sparsity=8.2101 nnzs=5550, refcount: 8>
  <dData2D:DM n=5550 m=1, refcount: 1>
refcount: 1>
No. of atoms with KB's overlaping orbs in proc 0. Max # of overlaps:      30     268
New grid distribution:   1
           1       1:   15    1:    8    1:   42
           2       1:   15    1:    8   43:   84
           3       1:   15    1:    8   85:  125
           4       1:   15    9:   15    1:   42
           5       1:   15    9:   15   43:   84
           6       1:   15    9:   15   85:  125

InitMesh: MESH =    30 x    30 x   250 =      225000
InitMesh: (bp) =    15 x    15 x   125 =       28125
InitMesh: Mesh cutoff (required, used) =   400.000   431.839 Ry
ExtMesh (bp) on 0 =   115 x   108 x   134 =     1664280
New grid distribution:   2
           1       1:   15    1:   15    1:   55
           2       1:   15    1:   15   64:   67
           3       1:   15    1:   15   56:   59
           4       1:   15    1:   15   60:   63
           5       1:   15    1:   15   68:   71
           6       1:   15    1:   15   72:  125
New grid distribution:   3
           1       1:   15    1:   15   57:   63
           2       1:   15    1:   15   49:   56
           3       1:   15    1:   15   78:  125
           4       1:   15    1:   15   64:   70
           5       1:   15    1:   15    1:   48
           6       1:   15    1:   15   71:   77
Setting up quadratic distribution...
ExtMesh (bp) on 0 =   115 x   115 x   147 =     1944075
PhiOnMesh: Number of (b)points on node 0 =                12375
PhiOnMesh: nlist on node 0 =               231320

stepf: Fermi-Dirac step function

siesta: Program's energy decomposition (eV):
siesta: Ebs     =       -99.703962
siesta: Eions   =       511.194752
siesta: Ena     =       113.391931
siesta: Ekin    =       221.096255
siesta: Enl     =       -22.739577
siesta: Eso     =         0.000000
siesta: Eldau   =         0.000000
siesta: DEna    =       -13.622446
siesta: DUscf   =         1.367936
siesta: DUext   =         0.000000
siesta: Enegf   =         0.000000
siesta: Exc     =      -112.753120
siesta: eta*DQ  =         0.000000
siesta: Emadel  =         0.000000
siesta: Emeta   =         0.000000
siesta: Emolmec =         0.000000
siesta: Ekinion =         0.000000
siesta: Eharris =      -320.218273
siesta: Etot    =      -324.453773
siesta: FreeEng =      -324.453773

        iscf     Eharris(eV)        E_KS(eV)     FreeEng(eV)     dDmax    Ef(eV) dHmax(eV)
   scf:    1     -320.218273     -324.453773     -324.453773  1.773722 -7.314159  4.951664
timer: Routine,Calls,Time,% = IterSCF        1       0.534   2.07
   scf:    2     -324.674169     -324.566974     -324.566974  0.064024 -6.383415  3.240777
   scf:    3     -324.726714     -324.659959     -324.659959  0.113991 -4.655256  0.099754
   scf:    4     -324.659871     -324.659922     -324.659922  0.002317 -4.717348  0.026764
   scf:    5     -324.659990     -324.659957     -324.659957  0.001084 -4.725586  0.020065
   scf:    6     -324.660020     -324.659993     -324.659993  0.003009 -4.750629  0.002416
   scf:    7     -324.659993     -324.659993     -324.659993  0.000092 -4.750800  0.001199
   scf:    8     -324.659993     -324.659993     -324.659993  0.000104 -4.750886  0.000541
   scf:    9     -324.659993     -324.659993     -324.659993  0.000010 -4.750827  0.000479

SCF Convergence by DM+H criterion
max |DM_out - DM_in|         :     0.0000096753
max |H_out - H_in|      (eV) :     0.0004786316
SCF cycle converged after 9 iterations

Using DM_out to compute the final energy and forces
No. of atoms with KB's overlaping orbs in proc 0. Max # of overlaps:      30     268

siesta: E_KS(eV) =             -324.6600

siesta: E_KS - E_eggbox =      -324.6600

siesta: Atomic forces (eV/Ang):
----------------------------------------
   Tot    0.000000   -0.000000    0.000000
----------------------------------------
   Max    0.000366
   Res    0.000211    sqrt( Sum f_i^2 / 3N )
----------------------------------------
   Max    0.000366    constrained

Stress-tensor-Voigt (kbar):        0.75        0.74        0.01       -0.00       -0.00       -0.00
(Free)E + p*V (eV/cell)     -324.6935
Target enthalpy (eV/cell)     -324.6600

Broyden_optim: max_history for broyden:   5
Broyden_optim: cycle on maxit: T
Broyden_optim: initial inverse jacobian:   1.0000

Broyden_optim: No of elements:      6

outcoor: Relaxed atomic coordinates (fractional):           
    0.33333333    0.33333333    0.50000000   1       1  C.gga
    0.66666666    0.66666666    0.50000000   1       2  C.gga

coxmol: Writing XMOL coordinates into file Graphene.xyz                                                        
Computing bands...
*** Note: ParallelOverK option not used for Bands
siesta: PDOS info: 
siesta: e1, e2, sigma, nhist:   -10.00 eV    0.00 eV    0.04 eV    300

siesta: Program's energy decomposition (eV):
siesta: Ebs     =      -110.498606
siesta: Eions   =       511.194752
siesta: Ena     =       113.391931
siesta: Ekin    =       214.316544
siesta: Enl     =       -21.239921
siesta: Eso     =         0.000000
siesta: Eldau   =         0.000000
siesta: DEna    =        -9.384838
siesta: DUscf   =         0.844546
siesta: DUext   =         0.000000
siesta: Enegf   =         0.000000
siesta: Exc     =      -111.393503
siesta: eta*DQ  =         0.000000
siesta: Emadel  =         0.000000
siesta: Emeta   =         0.000000
siesta: Emolmec =         0.000000
siesta: Ekinion =         0.000000
siesta: Eharris =      -324.659993
siesta: Etot    =      -324.659993
siesta: FreeEng =      -324.659993

siesta: Final energy (eV):
siesta:  Band Struct. =    -110.498606
siesta:       Kinetic =     214.316544
siesta:       Hartree =    1510.645808
siesta:       Eldau   =       0.000000
siesta:       Eso     =       0.000000
siesta:    Ext. field =       0.000000
siesta:       Enegf   =       0.000000
siesta:   Exch.-corr. =    -111.393503
siesta:  Ion-electron =   -3220.940876
siesta:       Ion-ion =    1282.712033
siesta:       Ekinion =       0.000000
siesta:         Total =    -324.659993
siesta:         Fermi =      -4.750827

siesta: Stress tensor (static) (eV/Ang**3):
siesta:     0.000467    0.000000    0.000000
siesta:    -0.000000    0.000464    0.000000
siesta:    -0.000000   -0.000000    0.000006

siesta: Cell volume =        107.347655 Ang**3

siesta: Pressure (static):
siesta:                Solid            Molecule  Units
siesta:          -0.00000340         -0.00000342  Ry/Bohr**3
siesta:          -0.00031231         -0.00031394  eV/Ang**3
siesta:          -0.50037866         -0.50299806  kBar
(Free)E+ p_basis*V_orbitals  =        -323.319448
(Free)Eharris+ p_basis*V_orbitals  =        -323.319448

siesta: Electric dipole (a.u.)  =   -0.000000   -0.000000   -0.000000
siesta: Electric dipole (Debye) =   -0.000000   -0.000000   -0.000000
>> End of run:  28-AUG-2019  13:16:53
Job completed
